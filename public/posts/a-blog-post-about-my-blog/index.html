<!DOCTYPE html>
<html ⚡ lang="en">
	<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

<title>How it&#39;s made: This Blog</title>
    
<meta name="description" content="" />
<link rel="canonical" href="https://blog.heyitschris.com/posts/a-blog-post-about-my-blog/" >
<link rel="sitemap" href="https://blog.heyitschris.com/sitemap.xml" type="application/xml" /><meta property="og:title" content="How it&#39;s made: This Blog">
<meta property="og:url" content="https://blog.heyitschris.com/posts/a-blog-post-about-my-blog/">
<meta property="og:description" content="">
<meta property="og:image" content="https://blog.heyitschris.com/logo.png">
<meta property="og:type" content="article">
<meta property="og:site_name" content=""><meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How it&#39;s made: This Blog">
<meta name="twitter:url" content="https://blog.heyitschris.com/posts/a-blog-post-about-my-blog/">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://blog.heyitschris.com/logo.png">
<meta name="twitter:site" content="@chris_the_nagy"><meta name="theme-color" content="#333"/>
<link rel="manifest" href="https://blog.heyitschris.com/manifest.json">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.heyitschris.com/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.heyitschris.com/icons/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://blog.heyitschris.com/icons/apple-touch-icon.png"><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes  -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript>
    <style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style>
</noscript><style amp-custom>
    
        *,*::before,*::after{box-sizing:border-box}ul[class],ol[class]{padding:0}body,h1,h2,h3,h4,p,ul[class],ol[class],li,figure,figcaption,blockquote,dl,dd{margin:0}body{min-height:100vh;scroll-behavior:smooth;text-rendering:optimizeSpeed}ul[class],ol[class]{list-style:none}a:not([class]){text-decoration-skip-ink:auto}img{max-width:100%;display:block}input,button,textarea,select{font:inherit}.chroma{background-color:#fff}.chroma .err{color:#a61717;background-color:#e3d2d2}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.chroma .hl{display:block;width:100%;background-color:#ffc}.chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .k{color:#000;font-weight:700}.chroma .kc{color:#000;font-weight:700}.chroma .kd{color:#000;font-weight:700}.chroma .kn{color:#000;font-weight:700}.chroma .kp{color:#000;font-weight:700}.chroma .kr{color:#000;font-weight:700}.chroma .kt{color:#458;font-weight:700}.chroma .na{color:teal}.chroma .nb{color:#0086b3}.chroma .bp{color:#999}.chroma .nc{color:#458;font-weight:700}.chroma .no{color:teal}.chroma .nd{color:#3c5d5d;font-weight:700}.chroma .ni{color:purple}.chroma .ne{color:#900;font-weight:700}.chroma .nf{color:#900;font-weight:700}.chroma .nl{color:#900;font-weight:700}.chroma .nn{color:#555}.chroma .nt{color:navy}.chroma .nv{color:teal}.chroma .vc{color:teal}.chroma .vg{color:teal}.chroma .vi{color:teal}.chroma .s{color:#d14}.chroma .sa{color:#d14}.chroma .sb{color:#d14}.chroma .sc{color:#d14}.chroma .dl{color:#d14}.chroma .sd{color:#d14}.chroma .s2{color:#d14}.chroma .se{color:#d14}.chroma .sh{color:#d14}.chroma .si{color:#d14}.chroma .sx{color:#d14}.chroma .sr{color:#009926}.chroma .s1{color:#d14}.chroma .ss{color:#990073}.chroma .m{color:#099}.chroma .mb{color:#099}.chroma .mf{color:#099}.chroma .mh{color:#099}.chroma .mi{color:#099}.chroma .il{color:#099}.chroma .mo{color:#099}.chroma .o{color:#000;font-weight:700}.chroma .ow{color:#000;font-weight:700}.chroma .c{color:#998;font-style:italic}.chroma .ch{color:#998;font-style:italic}.chroma .cm{color:#998;font-style:italic}.chroma .c1{color:#998;font-style:italic}.chroma .cs{color:#999;font-weight:700;font-style:italic}.chroma .cp{color:#999;font-weight:700;font-style:italic}.chroma .cpf{color:#999;font-weight:700;font-style:italic}.chroma .gd{color:#000;background-color:#fdd}.chroma .ge{color:#000;font-style:italic}.chroma .gr{color:#a00}.chroma .gh{color:#999}.chroma .gi{color:#000;background-color:#dfd}.chroma .go{color:#888}.chroma .gp{color:#555}.chroma .gs{font-weight:700}.chroma .gu{color:#aaa}.chroma .gt{color:#a00}.chroma .gl{text-decoration:underline}.chroma .w{color:#bbb}body{max-width:100%;display:grid;grid-template-columns:repeat(12,1fr);grid-gap:1em 1em;font-size:1.2em;font-family:Courier New,sans-serif;line-height:1.6;color:#000}.header,.main,.footer{grid-column:4/span 6}.header{margin-top:1em}.header__menu{margin:0;padding:0;display:flex;overflow:auto;justify-content:flex-start;border:1px solid #333}.header__menu a{font-size:1.2em;white-space:nowrap;border-bottom:none}.header__menu a:hover{color:#d14}.header__menu__logo{line-height:0}.header__menu__logo svg{width:75px;height:75px;min-width:75px;min-height:75px}.header__menu__list{display:flex;flex-grow:1;flex-wrap:nowrap;align-items:center;justify-content:space-around}.header__menu__list li{padding:0 1em;display:inline}.main{min-width:0;min-height:80vh}.main .pagination{margin:3em auto 2em;display:flex;justify-content:space-between}.footer{display:flex;justify-content:space-between;flex-wrap:wrap}h1{font-size:3.5rem}h2{font-size:2.5rem}h3{font-size:2rem}h4{font-size:1.5rem}a{color:inherit;text-decoration:none;transition:background .3s;border-bottom:2px dashed #37474f}a:hover{border-color:#d14}.button{padding:.5em .75em;font-size:1.2em;text-align:center;border:1px solid #000;box-shadow:7px 7px 0 0 #333}.button:hover{color:#d14;border:1px solid #000;transform:translate(4px,4px);box-shadow:3px 3px 0 0 #333}li{margin-top:.25em}pre,code{font-family:lucida console,Monaco,monospace;font-size:12pt;background-color:#f1f1f1}blockquote{margin:inherit auto;margin-left:1em;padding:1em;border-left:5px solid #999}blockquote:before{display:none}blockquote:not(:first-of-type){margin-top:.5em}blockquote p{color:#555;font-size:1.25em;font-family:times new roman,serif}.figure{width:100%;max-width:100%}.figure--with-caption{display:flex;border-top:6px solid #333}.figure__image--with-caption{min-width:70%}.figure__caption{background-color:#333;color:#fff;font-weight:700;padding:.5em 1em;height:min-content;word-wrap:break-word}.post-it{width:100%;padding:1.5em}.post-it--tip{background-color:#fffacd}.post-it--info{background-color:azure}.post-it--danger{background-color:#ffcccb}.post-it--success{background-color:#d0f0c0}.post-it__title{font-weight:700;font-size:1.5em}.post-it__content{margin-top:1em}.product{width:100%;display:flex;justify-content:space-between;padding:1.5em;border:1px solid #333}.product__image{margin:auto;width:100%;min-width:250px;max-width:400px}.product__content{margin-left:2em;align-self:center;display:flex;flex-direction:column}.product__title{font-weight:700;font-size:1.5rem}.product__description{margin-top:1em}.product__cta{margin-top:1em}.social-share{display:flex;align-self:center;align-items:center}.social-share__button{margin:0 .5em;border-radius:50%;background-size:60%}#tags{margin:0;padding:0}#tags li{display:inline}.content{width:100%}.content>*{margin-top:1.5em}.content>h1{margin-top:.5em}.content pre{overflow:auto;padding:.5em}.content code{padding:.1em}.content table{display:block;overflow-x:auto;border-collapse:collapse}.content table td,.content table th{border:1px solid #ddd}.content table td{padding:.5em 1em}.content table th{padding:1em 2em;background-color:#333;color:#fff}.content table tr:nth-child(even){background-color:#f1f1f1}.content table tr:hover{background-color:#ddd}.content .highlight .chroma{background-color:#f1f1f1}.content .under-title{display:flex;flex-wrap:wrap;justify-content:space-between;font-size:1rem}.content .under-title__info,.content .under-title__social-share{align-self:center}.content .ad{display:flex;margin:1rem auto;align-content:center;width:min-content;height:min-content;min-width:320px;min-height:320px;border:1px solid #333}.content .ad__fallback{display:flex;align-items:center}.content .ad__fallback p{margin:auto}.content .author{display:flex;flex-direction:column;align-items:center;background-color:#f1f1f1;padding:1.5rem}.content .author>*:not(:first-child){margin-top:1rem}.content .author__name{font-weight:700;font-size:1.5em}.content .author__image{border-radius:100px}.content .author__bio,.content .author__cta{text-align:center}.content .author__cta{font-size:1.25em}.summary:not(:first-of-type) h2{margin-top:2.5em}.summary>*{margin-top:1.25em}.summary__title{text-align:center}.summary .button{display:block;margin:inherit 1em}@media(max-width:1200px){body{grid-gap:0}.main,.header,.footer{grid-column:1/span 12}.main,.footer{margin:1em .75em 0 .5em}.header{margin:0}.header__menu{border:none;border-bottom:1px solid #333}h1{font-size:2.5rem}h2{font-size:2rem}h3{font-size:1.66rem}h4{font-size:1.25rem}.post-it{margin-left:0;margin-right:0}}@media(max-width:600px){.under-title__social-share{width:100%;margin-top:1.5em;justify-content:space-between}.figure{flex-direction:column-reverse}.figure--with-caption{border-top:none}.figure__caption{position:relative;max-width:100%}.product{flex-wrap:wrap}.product__content{margin-left:unset;text-align:center}.product__title{margin-top:1em}}
    
    
</style><script async src="https://cdn.ampproject.org/v0.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script><script async custom-element="amp-install-serviceworker" src="https://cdn.ampproject.org/v0/amp-install-serviceworker-0.1.js"></script><script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>

</head>
	<body><amp-install-serviceworker
  src="https://blog.heyitschris.com/sw.js"
  data-iframe-src="https://blog.heyitschris.com/install-sw.html"
  layout="nodisplay">
</amp-install-serviceworker>




  
  
  

  
  
  
    
  

  
  
  
    
  

  
  
  


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      
        
        {
          "@type": "ListItem",
          "position":  1 ,
          "item": {
            "@id": "https:\/\/blog.heyitschris.com",
            "name": "Home"
          }
        }
      
        ,
        {
          "@type": "ListItem",
          "position":  2 ,
          "item": {
            "@id": "https:\/\/blog.heyitschris.com\/posts\/",
            "name": "Posts"
          }
        }
      
        ,
        {
          "@type": "ListItem",
          "position":  3 ,
          "item": {
            "@id": "https:\/\/blog.heyitschris.com\/posts\/a-blog-post-about-my-blog\/",
            "name": "A blog post about my blog"
          }
        }
       ]
  }
</script><script type="application/ld+json">
  {
    "@context":"http://schema.org",
    "@type": "BlogPosting",
    "image": "https:\/\/blog.heyitschris.com",
    "url": "https:\/\/blog.heyitschris.com\/posts\/a-blog-post-about-my-blog\/",
    "headline": "How it\u0027s made: This Blog",
    "alternativeHeadline": "How it\u0027s made: This Blog",
    "dateCreated": "2020-06-27T16:12:39",
    "datePublished": "2020-06-27T16:12:39",
    "dateModified": "2020-06-27T16:12:39",
    "inLanguage": "en",
    "isFamilyFriendly": "true",
    "copyrightYear": "2020",
    "copyrightHolder": "",
    "accountablePerson": {
      "@type": "Person",
      "name": "",
      "url": ""
    },
    "author": {
      "@type": "Person",
      "name": "",
      "url": "https:\/\/blog.heyitschris.com",
      "image": "https:\/\/blog.heyitschris.com",
      "description": ""
    },
    "creator": {
      "@type": "Person",
      "name": "",
      "url": "https:\/\/blog.heyitschris.com",
      "image": "https:\/\/blog.heyitschris.com",
      "description": ""
    },
    "publisher": {
      "@type": "Organization",
      "name": "Hey, it\u0027s Chris",
      "url": "https:\/\/blog.heyitschris.com",
      "logo": {
        "@type": "ImageObject",
        "url": "\/",
        "width":"600",
        "height":"60"
      }
    },
    "mainEntityOfPage": "https:\/\/blog.heyitschris.com\/posts\/a-blog-post-about-my-blog\/",
    "keywords": "null",
    "genre": "null",
    "articleSection": "Posts"
  }
</script><header class="header"><nav class="header__menu">
    <a class="header__menu__logo" data-rel="prefetch" href="https://blog.heyitschris.com" aria-label="Go back to the homepage"></a>
<ul class="header__menu__list">
    
    
        
        <li>
            <a href="https://blog.heyitschris.com"
                 data-rel="prefetch"
                >
                <span>Home</span>
            </a>
        </li>
    
        
        <li>
            <a href="https://blog.heyitschris.com/about"
                 data-rel="prefetch"
                >
                <span>About</span>
            </a>
        </li>
    
        
        <li>
            <a href="https://github.com/what-name"
                 target="_blank" rel="nofollow noopener noreferrer" >
                <span>GitHub</span>
            </a>
        </li>
    
        
        <li>
            <a href="https://heyitschris.com"
                 target="_blank" rel="nofollow noopener noreferrer" >
                <span>Resume</span>
            </a>
        </li>
    
        
        <li>
            <a href="https://twitter.com/chris_the_nagy"
                 target="_blank" rel="nofollow noopener noreferrer" >
                <span>Twitter</span>
            </a>
        </li>
    
</ul></nav></header>
		<main class="main">
	<article class="content">
		<h2 id="how-its-made-this-blog">How it&rsquo;s made: This Blog.</h2>
<p>I&rsquo;ve always wanted to have a blog. Putting my thoughts into writing has always benefitted me and I&rsquo;ve definitely started paying more attention to do it as often as I can. After I completed <a href="https://forrestbrazeal.com/">Forrest Brazeal&rsquo;s</a> <a href="https://cloudresumechallenge.dev/">Cloud Resume Challange</a> and had my own website running on Serverless AWS, I thought why not extend it with a blog. I wrote some articles on my Medium page as well, but seeing #100DaysOfCode &amp; #100DaysOfCloud take off, I decided it&rsquo;s time to make my own. This is the intorductory story, now let&rsquo;s get down to the <em>how</em>.</p>
<p><img src="/images/hugo-screenshot.png" alt="Hugo Screenshot"></p>
<p>I knew I wanted to host everything as a static website on AWS. This ruled out Wordpress, which I really didn&rsquo;t want to go with because despite it being used for ~30% of the whole internet, is a ancient framework and frankly just too much for this project. The modern way is JAMStack, and the perfect candidate was <a href="https://gohugo.io/">Hugo</a>. Hugo is a static site generator with amazing features and a broad theme selection. It also allows you to write in <code>Markdown</code> which I so desperately love. The local setup is <strong>super</strong> easy and straighforward with their <a href="https://gohugo.io/getting-started/quick-start/">Quickstart</a> guide. I won&rsquo;t repeat what they have on their website, rather I&rsquo;ll just give my 2 cents on the experience and a kind-of guide.</p>
<h4 id="lets-get-into-it">Let&rsquo;s get into it!</h4>
<p>After installing Hugo with <code>brew</code> and creating the quickstart template, I looked around for a minimalist theme and found <a href="https://themes.gohugo.io/amperage/">Amperage</a>. I modified the <code>config.toml</code> a bit until I ended up with something I like. I don&rsquo;t have much experience in HTML&amp;CSS and since Hugo was a brand new framework for me, I turned to YouTube for a ~20min tutorial which gave me everything I needed. In the process, I realized how <strong>great</strong> the JAMStack architecture is and how easy it is to deploy and create static websites.</p>
<p>Since I wanted this blog to be hosted straight in S3, I added the extra resources in my current CloudFormation template for my resume project, did a <code>git push</code> and my existing GitHub Actions CI/CD pipeline for the backend handled the rest. There is a seperate repository for this blog on my GitHub as well and it has it&rsquo;s own CI/CD workflow, but I wanted to deploy it from my machine first. This is where I scratched my head a bit, because the <code>hugo deploy</code> command doesn&rsquo;t currently support using the <code>--profile</code> flag like the AWS CLI, and my website lives in an Organizations sub-account. Fear none, <code>nano ~/.aws/credentials</code> and set the default access keys to the correct ones. I did a <code>hugo deploy --dryRun</code> at first as any cautious techie would do (<em>right?</em>) and it grabbed the instructions from my previously configured <code>config.toml</code> file. All in all, it was wonderfully easy to get everything up &amp; running in less than an hour including the theme, the basic- and the deployment configs.</p>
<p>One gotcha I realized is that you <em>have to build the static site</em> before you want to deploy. This is done by simply executing the <code>hugo</code> command in the project&rsquo;s root directory. This builds the static files, &ldquo;compiling&rdquo; everything into a finished product. The error you get if you don&rsquo;t do this says <code>the folder /public does not exist</code> - this is the reason why.</p>
<p><img src="https://media.giphy.com/media/YQitE4YNQNahy/giphy.gif" alt="hacker"></p>
<h4 id="github-actions-cicd-for-hugo">GitHub Actions CI/CD for Hugo</h4>
<p>Humans make mistakes all the time and we&rsquo;re pretty unreliable at doing tasks in a precise and repeatable manner. This is why I opted to use a GitHub Actions workflow to deploy this site from its repository to the S3 bucket as well. Hugo is very developer-friendly so there are clear instructions and a pre-made GitHub action by a community member. I grabbed the template, added my <em>deploy-to-s3</em> job and <code>git push</code> that baby. Here&rsquo;s the <code>main.yml</code> file for the workflow:</p>
<pre><code class="language-linenos=table" data-lang="linenos=table">name: Deploy to S3 bucket

on:
  push:
    branches:
      - master

jobs:
  deploy:
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: true  # Fetch Hugo themes (true OR recursive)
          fetch-depth: 0    # Fetch all history for .GitInfo and .Lastmod

      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: &#39;latest&#39;
          # extended: true

      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v1
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: us-east-1
          
      - name: Hugo build
        run: hugo --minify

      - name: Hugo deploy static site to S3 bucket
        run: hugo deploy</code></pre>
<p>As you see, you should <strong>never</strong> commit access and secret keys to your repos. This is why you see <code>AWS_ACCESS_KEY_ID</code> in the <em>Configure AWS Credentials</em> part. GitHub offers <code>Secrets</code> which are encrypted environment variables that you can reference in your workflows and they are safe to use (even in public repos).</p>
<p><img src="https://media.giphy.com/media/lkK7hFTOp1s4g/giphy.gif" alt="itshappening"></p>
<h4 id="the-aws-side">The AWS side</h4>
<p>After all the backend was established - the CloudFront distribution, the CI/CD pipeline, the CloudFormation template - the only thing left was to add the <code>blog.heyitschris.com</code> entry into Route53. There is a deployment pipeline for every piece of the whole website at this point, so this step was nothing more than an extra resource in the CloudFormation template and <code>git push</code>. The resource deployed, this sentence finished and this blog&rsquo;s first iteration up &amp; running publicly.</p>
<h4 id="problems-after-the-deployment">Problems after the deployment</h4>
<p>Here is the part that makes this setup quite complicated on the backend to work. Since I am using CloudFront as a CDN in front of the bucket, using an <code>S3Origin</code> resource gives an <strong>Access Denied</strong> error on any of the <code>/posts/this-post</code> URLs. The reason I still haven&rsquo;t fully understood but the main point is that with Hugo, the distribution has to have the S3 Website <strong>Endpoint URL</strong> as an origin, meaning this: <code>${BlogWebsiteBucket}.s3-website-${AWS::Region}.amazonaws.com</code>. In order to do this, the bucket has to have all public access, since it&rsquo;s impossible to use an OAI with an endpoint URL. <a href="https://lustforge.com/2016/02/27/hosting-hugo-on-aws/">This blog post helped me</a> figure it out, but I&rsquo;ll be writing one on here as well detailing the CloudFormation template.</p>
<h4 id="closing-thoughts">Closing thoughts</h4>
<p>If you&rsquo;d like to see the repo, you can <a href="https://github.com/what-name/heyitschris.com-blog">reach it here</a>!</p>

</article>

		</main>
		<footer class="footer"><div class="footer__copyright">© Chris Nagy 2020</div><div class="footer__languages">
	
</div></footer>
	</body>
</html>
